
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link  rel="stylesheet" href="bostrap/css/bootstrap.min.css" >
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link  rel="stylesheet" href="css/estili4.css" >
  <link  rel="stylesheet" href="css/estilo9.css" >
  <link  rel="stylesheet" href="css/estilous.css" >
  <title>Document</title>
  <div class="profile">

    <h1 class="text-light"><a id="logeado"></a></h1>



</div>
</head>
<body onload =" CargarInfo()" id = "main">


<div id ="sidemenu" class="menu-expanded">

<div id="header">

<div id="title"><span></span></div>
<div id="menu-btn">




</div>
</div>
<div id="profile">
  <div id="photo"><img src="img/h.png" alt=""></div>
  <div id="name"><span>Cliente</span></div>
  <div class="cuadrous1">
    <input type="text" name="inputname" id = "us" readonly>
  </div>
</div>


<div id ="menu-items">

<div class="item">

<a href="javascript:inicio()">

  <div class="icon"><img src="img/c.png" alt=""></div>
  <div class="mane"><span>Salir del Sistema</span></div>


</a>



</div>
<div class="item">

  <a href="perfilusuario.html">

    <div class="icon"><img src="img/1.png" alt=""></div>
    <div class="mane"><span>MI Perfil</span></div>

  </a>

  </div>
  <div class="item">

    <a href="ventanaplaylist.html">

      <div class="icon"><img src="img/usuario.png" alt=""></div>
      <div class="mane"><span>My Playlist</span></div>

    </a>

    </div>





</div>
</div>

<div class="ventana"   id="vent2"><h1><center>Usuarios Registrados</center></h1>

  <p><center>
    <input id="Usuario"  type="text" class="control1" placeholder="Buscar"  >

  </center></p>
  <p><center>
    <button onclick="Buscar()" type="button" class="btn btn-danger">Buscar</button>
</center></p>
</div>


<div class ="Diseño">

  <ul class="nav nav-tabs">
    <li class="nav-item">
      <a class="nav-link active" href="#"><h4>Canciones  Disponibles en el Sistema</h4></a>
    </li>
    <li class="nav-item dropdown">
      <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Solicitudes</a>
      <div class="dropdown-menu">
        <a class="dropdown-item" href="index.html">Cerrar Sesion</a>
        <a class="dropdown-item" href="#"></a>
        <a class="dropdown-item" href="#"></a>
        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="javascript:form()">Solicitar una Cancion</a>
      </div>

    </li>


    <li class="search-icon">
      <input class="ser" id = "artista"  type ="Search" placeholder ="Search Music"/></input>
       <a href="javascript:Bus()" class="fa fa-search"></a>
    </li>
  </ul>


<div class="Diseño2" id="dis">

  <table class="table">
    <thead align="center" >
<tr>
             <th scope="col">Spotify</th>
             <th scope ="col">Youtube</th>

</tr>
    </thead>
    <tbody id="Cuerpo">
    </tbody>
  </table>



  <script>

    function CargarInfo(){
      var contenido = document.querySelector('#Cuerpo')
      contenido.innerHTML = ""
        fetch('https://musicstationbackend201700852.herokuapp.com//c')
        .then(response => response.json())
        .catch(error => {
            console.log(error)
          })
          .then(res => {


            for (var i in res) {
              console.log(res[i])
              contenido.innerHTML +=
              `<tr>

               <th><iframe src="${res[i].spotify}" width="300" height="390" frameborder="0" allowtransparency="true" allow="encrypted-media" ></iframe><button type="button" value="${res[i].artista}" onclick="myfuntion(this)" class="bt"><h5>Ver Detalles</h5></button>&nbsp;&nbsp;<button type="button" value="${res[i].artista}" onclick="myfuntion2(this)" class="bt"><h5>Ver Portada</h5></button>&nbsp;&nbsp;<button type="button" value="${res[i].artista}"   onclick=" myfuntion3(this)" class="bt"><h5>Agregar a mi Playlist</h5></button></th>
               <th><iframe src="${res[i].youtube}" width="560" height="315" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><button type="button" value="${res[i].artista}" onclick="myfuntion(this)" class="bt"><h5>Ver Detalles</h5></button>&nbsp;&nbsp;<button type="button" value="${res[i].artista}" onclick="myfuntion2(this)" class="bt"><h5>Ver Portada</h5></button>&nbsp;&nbsp;<button type="button" value="${res[i].artista}" onclick="myfuntion3(this)" class="bt"><h5>Agregar a mi Playlist</h5></button></th>



            </tr>`
                }

            })

            adminus()
          }
    </script>

            <script>

              function myfuntion(boton){
  var cancion = boton.value

sessionStorage.setItem("artista", cancion)

location.href="playlist.html"

              }
            </script>

            <script>

        function myfuntion2(boton){
  var cancion = boton.value

sessionStorage.setItem("ar", cancion)

location.href="portada.html"

              }
            </script>


            <script>
 async function myfuntion3(boton){
  var cancion = boton.value
sessionStorage.setItem("artista", cancion)
infor()
              }
            </script>

<!--AQUI ES PARA CARGAR LA INFORMACION-->

<input id="spo"  type="text" class="control1" placeholder="Buscar" style="visibility:hidden">
<input id="spo2"  type="text" class="control1" placeholder="Buscar" style="visibility:hidden">

<script>

  async  function infor(){
    var cargar = sessionStorage.artista
    fetch(`https://musicstationbackend201700852.herokuapp.com//c2/${cargar}`)
             .then(response => response.json())
             .catch(error => {
               console.log(error)
             })
             .then(res =>{
               console.log(res)
               document.querySelector('#spo').value = res.spotify
               document.querySelector('#spo2').value = res.youtube
               Regis()
             })
       }
        </script>

<!--FIN DEL PROCESO-->

<!--AQUI ES PARA INGRESAR UNA CANCION ALA VEZ-->
<script>
  function Regis(){
     var Nombre = document.querySelector('#spo').value
     var Nombre1 = document.querySelector('#spo2').value
     var objeto = {
       'cancion':Nombre,
       'cancion2':Nombre1
   }
   console.log(objeto)
   fetch('https://musicstationbackend201700852.herokuapp.com//agregados', {
   method: 'POST',
   body: JSON.stringify(objeto),
   headers:{
       'Content-Type': 'application/json'
   }
 }).then(res => res.json())
 .catch(err => {
 console.error('Error:', err)
 alert("Ocurrio un error, ver la consola")
 })
 .then(response =>{
 console.log('Success',response);
 console.log(response.message)
 if(response.message == "Failed"){
     alert(response.reason)
 }else{
  swal('Se ha agregado la cancion a su playlist','','success');
 }
 })
 }
</script>
<!--FIN DEL INGRESO DE UNA CANCION ALA VEZ-->
</div>
</div>
<!--AQUI VAN LOS DATOS Y LAS TABLAS-->
     <script>

function abrir(){
document.getElementById("vent").style.display ="block";
document.getElementById("vent2").style.display ="block";
}
     </script>
  </div>
<!--AQUI VAN LOS DATOS Y LAS TABLAS-->
<script>
const btn =document.querySelector('#menu-btn');
const menu =document.querySelector('#sidemenu');
btn.addEventListener('click',e => {
menu.classList.toggle("menu-expanded");
menu.classList.toggle("menu-collapsed");
document.querySelector('body').classList.toggle('body-expanded');
});
</script>
<script>
function inicio(){
  location.href="index.html"
}
</script>

<!--AQUI ES PARA CREAR UNA NUEVA CANCION DE PARTE DEL CLIENTE-->

<div class = "crearnuvacancion" id="solicitud">

  <form class = "ad">

    <h2>Formulario de Solicitud</h2>
    <label>Titulo de la cancion</label>
    <input id="Titulo"   type="text" class="form-control2" placeholder="titulo" >
    <label>Nombre del Artista</label>
    <input id="Artista"  type="text" class="form-control3" placeholder="artista" >
    <label>Nombre del Album</label>
    <input id="Album"   type="text" class="form-control4" placeholder="album" >
    <label>Fecha de lanzamiento</label>
    <input id="Fecha"  type="text" class="form-control5" placeholder="fecha de lanzamiento"  >
    <label>Imagen de la portada</label>
    <input id="Imagen"   type="text" class="form-control4" placeholder="la imagen no es necesario" >
    <label>Linlk de Spotify</label>
    <input id="Spotify"  type="text" class="form-control5" placeholder="link de spotify"  >
    <label>Link de Youtube</label>
    <input id="Youtube"  type="text"  class="form-control5" placeholder="link de youtube" ><br><br>
    <button onclick ="Registro2()"  type="button" class="btn btn-danger">Enviar Solicitud</button><br><br>
    <button onclick ="javascript:form2()"  type="button" class="btn btn-success">Cerrar formulario</button>

  </form>
<!--AQUI ES PARA LAS SOLICITUDES-->
<script>
  function Registro2(){

    var nombre = document.querySelector('#Titulo').value
    var artista = document.querySelector('#Artista').value
    var album = document.querySelector('#Album').value
    var fecha = document.querySelector('#Fecha').value
    var imagen  = document.querySelector('#Imagen').value
    var spotify = document.querySelector('#Spotify').value
    var youtube  = document.querySelector('#Youtube').value


    var objeto = {
      'nombre':nombre,
      'artista':artista,
      'album':album,
      'fecha':fecha,
      'imagen':imagen,
      'spotify':spotify,
      'youtube':youtube

  }
  console.log(objeto)

  fetch('https://musicstationbackend201700852.herokuapp.com//Solicitud', {

  method: 'POST',
  body: JSON.stringify(objeto),
  headers:{
      'Content-Type': 'application/json'
  }

}).then(res => res.json())
.catch(err => {
console.error('Error:', err)
alert("Ocurrio un error, ver la consola")
})
.then(response =>{

console.log('Success',response);
console.log(response.message)
if(response.message == "Failed"){
    alert(response.reason)

}else{
   // alert(response.reason)
swal('Su solicitud para una nueva cancion ha sido enviada','Espere confirmacion en menos de 24 horas','success')

}
})
}




</script>




<!--AQUI ES PARA LAS SOLICITUDES-->



</div>


<script>
function form(){


  document.getElementById("solicitud").style.display ="block";



}

function form2(){


  document.getElementById("solicitud").style.display ="none";



}

</script>

<script>
  function Bus(){

    var username = document.querySelector('#artista').value


    var objeto = {
      'artista': username,

  }
  console.log(objeto)

  fetch('https://musicstationbackend201700852.herokuapp.com//Buscar3', {

  method: 'POST',
  body: JSON.stringify(objeto),
  headers:{
      'Content-Type': 'application/json'
  }

  }).then(res => res.json())
  .catch(err => {
  console.error('Error:', err)
  alert("Ocurrio un error, ver la consola")
  })
  .then(response =>{

  console.log(response);
  console.log(response.message)
  if(response.message == "Failed"){
    alert("La cancion no existe")

  }else{
    alert(`Se ha encontrado la cancion con nombre de artista, ${username}`)
    sessionStorage.setItem("artista",username)
    location.href="playlist.html"
  }
  })
  }

</script>



<!--FIN DE CREAR UNA NUEVA CANCION-->





<!--1. AQUI ES PARA ACCEDER A LOS DATOS DEL USUARIO TIPO CLIENTE-->

<script>

  function adminus(){



      var cargar = sessionStorage.Usuario


     fetch(`https://musicstationbackend201700852.herokuapp.com//Datosper/${cargar}`)
              .then(response => response.json())
              .catch(error => {
                console.log(error)
              })
              .then(res =>{
                console.log(res)


                document.querySelector('#us').value = res.Usuario




              })
        }

</script>


<!--FIN PARA DE LA LINEA 1-->
</body>
</html>